apiVersion: 1

providers:
  - name: "DES Tombstone"
    orgId: 1
    folder: ""
    type: file
    options:
      path: /etc/grafana/provisioning/dashboards

dashboard:
  title: DES Tombstone Management
  panels:
    - title: Tombstone Creation Rate
      type: graph
      query: rate(des_tombstones_created_total[5m])

    - title: Cache Hit Rate
      type: gauge
      query: |
        rate(des_metadata_cache_hits_total[5m])
        /
        (rate(des_metadata_cache_hits_total[5m]) + rate(des_metadata_cache_misses_total[5m]))
      thresholds:
        - value: 0.8
          color: green
        - value: 0.5
          color: yellow

    - title: Metadata Rebuilds
      type: stat
      query: rate(des_metadata_rebuilds_total[5m])

    - title: DELETE API Status
      type: graph
      query: rate(http_requests_total{method="DELETE"}[5m]) by (status)
